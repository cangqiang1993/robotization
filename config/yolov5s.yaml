# YOLOv5 🚀 by Ultralytics, GPL-3.0 license
# 游戏目标检测专用配置文件

# --------------------------- 模型架构 ---------------------------
nc: 5  # 检测类别数 (根据游戏目标调整)
depth_multiple: 0.33  # 模型深度系数
width_multiple: 0.50  # 层通道系数

# ------------------------- 锚点框配置 -------------------------
anchors:
  - [10,13, 16,30, 33,23]    # P3/8  (小目标层)
  - [30,61, 62,45, 59,119]   # P4/16 (中目标层)
  - [116,90, 156,198, 373,326] # P5/32 (大目标层)

# ------------------------- 主干网络 -------------------------
backbone:
  # [来源, 重复次数, 模块, 参数]
  [[-1, 1, Focus, [64, 3]],     # 0-P1/2
  [[-1, 1, Conv, [128, 3, 2]],   # 1-P2/4
  [[-1, 3, C3, [128]],
  [[-1, 1, Conv, [256, 3, 2]],   # 3-P3/8
  [[-1, 6, C3, [256]],
  [[-1, 1, Conv, [512, 3, 2]],   # 5-P4/16
  [[-1, 9, C3, [512]],
  [[-1, 1, Conv, [1024, 3, 2]],  # 7-P5/32
  [[-1, 3, C3, [1024]],
  [[-1, 1, SPPF, [1024, 5]],     # 9

# ------------------------- 检测头 -------------------------
head:
  [[-1, 1, Conv, [512, 1, 1]],
  [[-1, 1, nn.Upsample, [None, 2, 'nearest']],
  [[-6, 1, Conv, [512, 1, 1]],   # 特征融合
  [[-2, -1], 1, Concat, [1]],
  [[-1, 3, C3, [512, False]],

  [[-1, 1, Conv, [256, 1, 1]],
  [[-1, 1, nn.Upsample, [None, 2, 'nearest']],
  [[-13, 1, Conv, [256, 1, 1]],  # 特征融合
  [[-2, -1], 1, Concat, [1]],
  [[-1, 3, C3, [256, False]],

  [[-1, 1, Conv, [256, 3, 2]],
  [[-1, -11], 1, Concat, [1]],
  [[-1, 3, C3, [512, False]],

  [[-1, 1, Conv, [512, 3, 2]],
  [[-1, -7], 1, Concat, [1]],
  [[-1, 3, C3, [1024, False]],

  [[[17, 20, 23], 1, Detect, [nc, anchors]],  # Detect层
]